---
# defaults file for ansible-suricata
config_suricata: false  #defines if suricata should be configured
scripts_dir: /opt/scripts
suricata_action_order:
  - pass
  - drop
  - reject
  - alert
suricata_af_packet_interfaces:
  - int: eth0
    threads: 1
    defrag: "yes"
    cluster_type: cluster_flow  #cluster_round_robin, cluster_flow or cluster_cpu
    cluster_id: 99
    copy_mode: ips
    copy_iface: eth1
    buffer_size: 64535
    disable_promisc: "no"  # Set to yes to disable promiscuous mode
    use_nmap: "yes"
  - int: eth1
    threads: 1
    defrag: "yes"
    cluster_type: cluster_flow  #cluster_round_robin, cluster_flow or cluster_cpu
    cluster_id: 98
    copy_mode: ips
    copy_iface: eth0
    buffer_size: 64535
    disable_promisc: "no"  # Set to yes to disable promiscuous mode
    use_nmap: "yes"
suricata_classification_file: /etc/suricata/classification.config
suricata_config_outputs: true
suricata_default_rule_path: /etc/suricata/rules
suricata_flow_timeouts:
  - name: default
    new: 30
    established: 300
    closed: 0
    emergency_new: 10
    emergency_established: 100
    emergency_closed: 0
  - name: tcp
    new: 60
    established: 3600
    closed: 120
    emergency_new: 10
    emergency_established: 100
    emergency_closed: 20
  - name: udp
    new: 30
    established: 300
    emergency_new: 10
    emergency_established: 100
  - name: icmp
    new: 30
    established: 300
    emergency_new: 10
    emergency_established: 100
suricata_host_mode: auto  #defines surica operating mode...Options are auto, router (IPS-Mode) or sniffer-only (IDS-Mode)
#    suricata_include_files:  #Files included here will be handled as if they were inlined in the configuration file.
#        - include1.yaml
#        - include2.yaml
suricata_interfaces:  #define the interfaces on your suricata host and define if offloading should be disabled.
  - int: eth0
    disable_offloading: false
    disable_features:
      - gro
      - gso
      - lro
      - rx
      - rxhash
      - rxvlan
      - sg
      - tso
      - tx
      - txvlan
      - ufo
  - int: eth1
    disable_offloading: false
    disable_features:
      - gro
      - gso
      - lro
      - rx
      - rxhash
      - rxvlan
      - sg
      - tso
      - tx
      - txvlan
      - ufo
suricata_log_dir: /var/log/suricata/
suricata_oinkmaster_rules_url: http://rules.emergingthreats.net/open/suricata/emerging.rules.tar.gz
suricata_outputs:
  - name: fast
    settings:
      - var: enabled
        val: "yes"
      - var: filename
        val: fast.log
      - var: append
        val: "yes"
  - name: eve-log
    settings:
      - var: enabled
        val: "yes"
      - var: type
        val: file  #file|syslog|unix_dgram|unix_stream
      - var: filename
        val: eve.json
      - var: types
        settings:
          - name: alert
          - name: http
            settings:
              - var: extended
                val: "yes"  # enable this for extended logging information
          - name: dns
          - name: tls
            settings:
              - var: extended
                val: "yes"  # enable this for extended logging information
          - name: files
            settings:
              - var: force_magic
                val: "yes"  # force logging magic on all logged files
              - var: force_md5
                val: "yes"  # force logging of md5 checksums
    #      - name: "drop"
          - name: ssh
          - name: smtp
          - name: flow
  - name: unified2-alert
    settings:
      - var: enabled
        val: "yes"
      - var: filename
        val: unified2.alert
      - var: limit
        val: 32mb  # File size limit.  Can be specified in kb, mb, gb.
      - var: xff
        settings:
          - var: enabled
            val: "no"
          - var: mode
            val: extra-data
          - var: header
            val: X-Forwarded-For
  - name: http-log
    settings:
      - var: enabled
        val: "yes"
      - var: filename
        val: http.log
      - var: append
        val: "yes"
  - name: tls-log
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: tls.log
      - var: append
        val: "yes"
      - var: certs_log_dir
        val: certs
  - name: dns-log
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: dns.log
      - var: append
        val: "yes"
  - name: pcap-info
    settings:
      - var: enabled
        val: "no"
  - name: pcap-log
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: log.pcap
      - var: limit
        val: 1000mb
      - var: max_files
        val: 2000
      - var: mode
        val: normal  # normal or sguil
      - var: use_stream_depth
        val: "no"  #If set to "yes" packets seen after reaching stream inspection depth are ignored. "no" logs all packets
  - name: alert-debug
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: alert-debug.log
      - var: append
        val: "yes"
  - name: alert-prelude
    settings:
      - var: enabled
        val: "no"
      - var: profile
        val: suricata
      - var: log_packet_content
        val: "no"
      - var: log_packet_header
        val: "yes"
  - name: stats
    settings:
      - var: enabled
        val: "yes"
      - var: filename
        val: stats.log
      - var: interval
        val: 8
  - name: syslog
    settings:
      - var: enabled
        val: "no"
      - var: facility
        val: local5
      - var: level
        val: Info  # possible levels: Emergency, Alert, Critical, Error, Warning, Notice, Info, Debug
  - name: drop
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: drop.log
      - var: append
        val: "yes"
  - name: file-store
    settings:
      - var: enabled
        val: "no"
      - var: log_dir
        val: files
      - var: force_magic
        val: "no"
      - var: force_md5
        val: "no"
  - name: file-log
    settings:
      - var: enabled
        val: "no"
      - var: filename
        val: files-json.log
      - var: append
        val: "yes"
      - var: force_magic
        val: "no"
      - var: force_md5
        val: "no"
suricata_pfring_interfaces:
  - int: eth0
    threads: 1
    cluster_id: 99
    cluster_type: cluster_flow
  - int: eth1
    threads: 1
    cluster_id: 93
    cluster_type: cluster_flow
suricata_reference_config_file: /etc/suricata/reference.config
suricata_rules:
  - botcc.rules
  - ciarmy.rules
  - compromised.rules
  - drop.rules
  - dshield.rules
  - emerging-activex.rules
  - emerging-attack_response.rules
  - emerging-chat.rules
  - emerging-current_events.rules
  - emerging-dns.rules
  - emerging-dos.rules
  - emerging-exploit.rules
  - emerging-ftp.rules
  - emerging-games.rules
  - emerging-icmp_info.rules
#        - emerging-icmp.rules
  - emerging-imap.rules
  - emerging-inappropriate.rules
  - emerging-malware.rules
  - emerging-misc.rules
  - emerging-mobile_malware.rules
  - emerging-netbios.rules
  - emerging-p2p.rules
  - emerging-policy.rules
  - emerging-pop3.rules
  - emerging-rpc.rules
  - emerging-scada.rules
  - emerging-scan.rules
  - emerging-shellcode.rules
  - emerging-smtp.rules
  - emerging-snmp.rules
  - emerging-sql.rules
  - emerging-telnet.rules
  - emerging-tftp.rules
  - emerging-trojan.rules
  - emerging-user_agents.rules
  - emerging-voip.rules
  - emerging-web_client.rules
  - emerging-web_server.rules
  - emerging-web_specific_apps.rules
  - emerging-worm.rules
  - tor.rules
  - decoder-events.rules # available in suricata sources under rules dir
  - stream-events.rules  # available in suricata sources under rules dir
  - http-events.rules    # available in suricata sources under rules dir
  - smtp-events.rules    # available in suricata sources under rules dir
  - dns-events.rules     # available in suricata sources under rules dir
  - tls-events.rules     # available in suricata sources under rules dir
suricata_ubuntu_ppa: ppa:oisf/suricata-stable  #Options are ppa:oisf/suricata-stable, ppa:oisf/suricata-beta or ppa:oisf/suricata-daily
suricata_unix_command:
  enabled: "no"
#        filename: custom.socket
